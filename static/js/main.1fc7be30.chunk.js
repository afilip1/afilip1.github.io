(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(7),l=n.n(i);n(14);Array.prototype.equals=function(e){return this.length===e.length&&this.every((function(t,n){return t===e[n]}))},Array.prototype.shuffle=function(){for(var e=this.length-1;e>0;e--){var t=Math.floor(Math.random()*(e+1)),n=[this[t],this[e]];this[e]=n[0],this[t]=n[1]}return this},Array.prototype.zip=function(e){return this.map((function(t,n){return[t,e[n]]}))},Array.prototype.withIndex=function(){return Array.from(this.entries())},Array.prototype.countBy=function(e){return this.filter(e).length};var o,c=function(e,t){return Array.from({length:t-e},(function(t,n){return n+e}))},u=n(1),s=n(5),f=n(3);function g(e){var t=e.initSize,n=e.initMineCount,a=function(e){var t=Object(r.useState)(e),n=Object(u.a)(t,2),a=n[0],i=n[1],l=Object(r.useCallback)((function(e){var t,n=[(t=e)%a,Math.floor(t/a)],r=Object(u.a)(n,2),i=r[0],l=r[1];return[[i-1,l-1],[i,l-1],[i+1,l-1],[i-1,l],[i+1,l],[i-1,l+1],[i,l+1],[i+1,l+1]].filter((function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return n>=0&&n<a&&r>=0&&r<a})).map((function(e){var t=Object(u.a)(e,2),n=t[0];return t[1]*a+n}))}),[a]);return{gridSize:a,setGridSize:i,getNeighbors:l}}(t),i=a.gridSize,l=a.setGridSize,c=a.getNeighbors,g=Object(r.useState)(n),d=Object(u.a)(g,2),m=d[0],v=d[1],b=Object(r.useState)(null),h=Object(u.a)(b,2),p=h[0],C=h[1],j=function(e){return{mines:[],revealed:Array(e*e).fill(!1),flagged:Array(e*e).fill(!1),adjacent:[]}},k=Object(r.useState)(j(i)),y=Object(u.a)(k,2),O=y[0],S=y[1],E=Object(r.useCallback)((function(e){var t=Array(i*i-1).fill(!0,0,m).fill(!1,m).shuffle();t.splice(e,0,!1);var n=t.withIndex().map((function(e){var n=Object(u.a)(e,2),r=n[0];return n[1]?null:c(r).countBy((function(e){return t[e]}))}));S(Object(f.a)({},O,{mines:t,adjacent:n}))}),[O,i,m,c]),z=Object(r.useCallback)((function(){var e=O.mines,t=O.revealed,n=O.flagged,r=e.map((function(e){return!e})),a=e.equals(n);return t.equals(r)&&a?o.Won:t.zip(e).some((function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return n&&r}))?o.Lost:o.InProgress}),[O]),R=Object(r.useCallback)((function(e){if(z()===o.InProgress){if(0===O.mines.length)return E(e),void C(e);var t=function(){for(var e=O.revealed,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(n.forEach((function(t){return e[t]=!0}));n.length>0;){var a=n.shift();if(0===O.adjacent[a]){var i=c(a).filter((function(t){return!e[t]}));i.forEach((function(t){return e[t]=!0})),n.push.apply(n,Object(s.a)(i))}}return Object(f.a)({},O,{revealed:e})};O.flagged[e]||(O.mines[e]?function(){var e=O.revealed.zip(O.mines).map((function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return n||r}));S(Object(f.a)({},O,{revealed:e}))}():O.revealed[e]?function(e){var n=c(e);if(n.filter((function(e){return O.flagged[e]})).length===O.adjacent[e]){var r=n.filter((function(e){return!(O.revealed[e]||O.flagged[e])}));S(t.apply(void 0,Object(s.a)(r)))}}(e):function(e){var n=t(e);n.flagged[e]=!1,S(n)}(e))}}),[O,z,c,E]);p&&(R(p),C(null));var A=function(e){var t=O.flagged.slice();t[e]=!t[e],S(Object(f.a)({},O,{flagged:t}))};return{gridSize:i,mineCount:m,setMineCount:v,board:O,resetBoard:function(e,t){l(e),v(t),S(j(e))},handleCellClick:R,handleCellRightClick:function(e,t){e.preventDefault(),z()===o.InProgress&&A(t)},flagCell:A,getGameState:z}}function d(e){var t,n=e.gameState,r=e.minesLeft;switch(n){case o.InProgress:t="Mines remaining: "+r;break;case o.Won:t="You win!";break;case o.Lost:t="You lose :("}return a.a.createElement("h1",null,t)}function m(e){var t=Object(r.useState)(e.gridSize),n=Object(u.a)(t,2),i=n[0],l=n[1],o=Object(r.useState)(e.mineCount),c=Object(u.a)(o,2),s=c[0],f=c[1];return a.a.createElement("div",null,a.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onSettingsUpdate(i,s)}},a.a.createElement("label",null,"Grid size:",a.a.createElement("input",{name:"gridSize",type:"text",value:i,onChange:function(e){l(+e.currentTarget.value)}})),a.a.createElement("label",null,"Mine count:",a.a.createElement("input",{name:"mineCount",type:"text",value:s,onChange:function(e){f(+e.currentTarget.value)}})),a.a.createElement("button",{type:"submit"},"Apply")),a.a.createElement("button",{onClick:e.onRestart},"Restart"),a.a.createElement(d,{gameState:e.gameState,minesLeft:e.minesLeft}))}!function(e){e[e.InProgress=0]="InProgress",e[e.Won=1]="Won",e[e.Lost=2]="Lost"}(o||(o={}));var v=n(8);function b(e){var t=e.isRevealed,n=e.onClick,r=e.onRightClick,i=e.children,l="cell";return t&&(l+=" cell-revealed"),a.a.createElement("button",{className:l,onClick:n,onContextMenu:r},i)}function h(e){var t=e.isFlagged,n=e.onClick,r=e.onRightClick;return a.a.createElement(b,{isRevealed:!1,onClick:n,onRightClick:r},t&&"\ud83d\udea9")}function p(e){var t=e.isMine,n=e.adjacentCount,r=e.onClick,i=[void 0,"blue","green","red","purple","maroon","turquoise","black","gray"];return a.a.createElement(b,{isRevealed:!0,onClick:r,onRightClick:function(e){return e.preventDefault()}},t&&"\ud83d\udca3",null!==n&&n>0&&a.a.createElement("span",{style:{color:i[n]}},n))}function C(e){var t=e.size,n=Object(v.a)(e,["size"]),r=c(0,t*t),i=c(0,t).map((function(e){return a.a.createElement("div",{className:"board-row",key:e},r.slice(e*t,(e+1)*t).map((function(e){return function(e,t){var n=e.board,r=n.mines,i=n.flagged,l=n.revealed,o=n.adjacent,c=e.onClick,u=e.onRightClick;return l[t]?a.a.createElement(p,{key:t,isMine:r[t],onClick:function(){return c(t)},adjacentCount:o[t]}):a.a.createElement(h,{key:t,isFlagged:i[t],onClick:function(){return c(t)},onRightClick:function(e){return u(e,t)}})}(n,e)})))}));return a.a.createElement("div",{className:"board"},i)}function j(){var e=g({initSize:9,initMineCount:10}),t=e.gridSize,n=e.mineCount,r=e.board,i=e.resetBoard,l=e.handleCellClick,o=e.handleCellRightClick,c=e.getGameState;return a.a.createElement("div",{className:"game",onContextMenu:function(e){return e.preventDefault()}},a.a.createElement(m,{gridSize:t,mineCount:n,gameState:c(),minesLeft:n-r.flagged.countBy(Boolean),onSettingsUpdate:function(e,t){return i(e,t)},onRestart:function(){return i(t,n)}}),a.a.createElement(C,{size:t,board:r,onClick:l,onRightClick:o}))}l.a.render(a.a.createElement(j,null),document.getElementById("root"))},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.1fc7be30.chunk.js.map